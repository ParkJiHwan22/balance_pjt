{% extends 'base.html' %}
{% load static %}

{% block content %}
  <div class="container w-50">
    <div class="d-flex align-items-center">
      <h1 class="text-center flex-grow-1">{{ post.title }}</h1>
      <p class="fs-6 text-end m-0 me-3">{{ post.user }}</p>
    </div>
    <hr class="mt-0 mb-3">


    <div class="d-flex justify-content-around">
      <div class="d-flex flex-column align-items-center col-4">
        {% if post.image_1 %}
          <img src="{{ post.image_1.url }}" alt="img" width='100%'>
        {% else %}
          <img src="{% static 'no-image.png' %}" alt="no-img" width='100%'>
        {% endif %}  
        <div class="my-3" style="word-wrap: break-word;">
          <form action="{% url 'posts:answer' post.pk post.select1_content %}" method="POST">
            {% csrf_token %}
              <input type="submit" value="{{ post.select1_content }} - {{ post.select1_users.count }}">
          </form>
        </div>
      </div>

      <div class='d-flex align-items-center mb-5'>
        <h1>vs</h1>
      </div>


      <div class="d-flex flex-column align-items-center col-4">
        {% if post.image_2 %}
          <img src="{{ post.image_2.url }}" alt="img" width='100%'>
        {% else %}
            <img src="{% static 'no-image.png' %}" alt="no-img" width='100%'>
        {% endif %}
        <div class="my-3" style="word-wrap: break-word;">
          <form action="{% url 'posts:answer' post.pk post.select2_content %}" method="POST">
            {% csrf_token %}
              <input type="submit" value="{{ post.select2_content }} - {{ post.select2_users.count }}">
          </form>
        </div>  
      </div>
    </div>
  
    

   



    <hr class="mt-0 mb-3">
    <div class="d-flex justify-content-between">
      <a href="{% url 'posts:index' %}" class="btn btn-outline-success">뒤로가기</a>
      <div class="d-flex justify-content-between">
      </div>
    </div>
  </div>


  <div class="container">  
    <form action="{% url 'posts:comment_create' post.pk %}" method="post">
        {% csrf_token %}
        {{ comment_post_form.as_p }}
    <input type="submit" value="댓글 작성">
    </form>
  </div>  
  {% for comment_post in comment_posts %}
  <div>
    <p>댓글 작성자 -
      {{comment_post.user}}</p>
    <p>댓글 번호 -
      {{ comment_post.pk }}</p>
    <p>
      댓글 내용 -
      {{comment_post.content}}
    </p>
    <form action="{% url 'posts:comment_likes' post.pk comment_post.pk %}" method="POST">
      {% csrf_token %}
      {% if request.user in comment_post.like_users.all %}
        <input type="submit" value="좋아요 취소">
      {% else %}
        <input type="submit" value="좋아요">
      {% endif %}
    </form>
    {% if comment_post.user == user %}
      <form action="{% url 'posts:comment_delete' post.pk comment_post.pk %}" method="POST">
        {% csrf_token %}
        <input type="submit" value="댓글 삭제">
      </form>
    {% endif %}
  </div>
  <hr>
{% endfor %}
{% for emotion in emotions %}
    <div>
      {% if request.user.is_authenticated %}
      {{emotion.queryset}}
        <form action="{% url 'posts:emotes' post.pk emotion.value %}" method="POST">
          {% csrf_token %}
          {% if emotion.exist %}
            <input type="submit" value="{{emotion.label}} 취소">
          {% else %}
            <input type="submit" value="{{emotion.label}}">
          {% endif %}
        </form>
      {% else %}
        <button disabled="disabled">{{emotion.label}}</button>
      {% endif %}
      <p>
        게시글 {{emotion.label}} 수 -
        {{ emotion.count }}
      </p>
    </div>
  {% endfor %}
{% endblock content %}